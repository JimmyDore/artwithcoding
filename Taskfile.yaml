version: '3'

tasks:
  demo:
    desc: "Run the distorsion movement demo"
    cmds:
      - echo "ğŸ¨ Starting distorsion movement demo..."
      - source venv/bin/activate && python distorsion_movement/demos.py
      - echo "âœ… Demo finished"

  demo:quick:
    desc: "Run quick demo with default settings"
    cmds:
      - echo "ğŸ¨ Starting quick windowed demo..."
      - source venv/bin/activate && python -c "from distorsion_movement import quick_demo; quick_demo()"

  demo:fullscreen:
    desc: "Run fullscreen demo"
    cmds:
      - echo "ğŸ¨ Starting fullscreen demo..."
      - source venv/bin/activate && python -c "from distorsion_movement import fullscreen_demo; fullscreen_demo()"

  test:
    desc: "Run all tests with pytest"
    cmds:
      - echo "ğŸ§ª Running all tests..."
      - source venv/bin/activate && pytest -v
      - echo "âœ… All tests completed"

  test:unit:
    desc: "Run only unit tests"
    cmds:
      - echo "ğŸ§ª Running unit tests..."
      - source venv/bin/activate && pytest -v -m "unit or not integration"
      - echo "âœ… Unit tests completed"

  test:integration:
    desc: "Run only integration tests"
    cmds:
      - echo "ğŸ§ª Running integration tests..."
      - source venv/bin/activate && pytest -v -m "integration"
      - echo "âœ… Integration tests completed"

  test:coverage:
    desc: "Run tests with coverage report"
    cmds:
      - echo "ğŸ§ª Running tests with coverage..."
      - source venv/bin/activate && pytest --cov=distorsion_movement --cov-report=term-missing --cov-report=html
      - echo "âœ… Coverage report generated in htmlcov/"

  test:watch:
    desc: "Run tests in watch mode"
    cmds:
      - echo "ğŸ§ª Running tests in watch mode..."
      - source venv/bin/activate && pytest-watch -- -v

  test:fast:
    desc: "Run fast tests only (exclude slow tests)"
    cmds:
      - echo "ğŸ§ª Running fast tests..."
      - source venv/bin/activate && pytest -v -m "not slow"
      - echo "âœ… Fast tests completed"

  test:validate:
    desc: "Validate the entire test suite setup and coverage"
    cmds:
      - echo "ğŸ” Validating test suite..."
      - echo "ğŸ“Š Running tests with coverage..."
      - source venv/bin/activate && pytest --cov=distorsion_movement --cov-report=term --cov-fail-under=80
      - echo "ğŸ§ª Running unit tests..."
      - source venv/bin/activate && pytest -v -m "unit" --tb=short
      - echo "ğŸ”— Running integration tests..."
      - source venv/bin/activate && pytest -v -m "integration" --tb=short
      - echo "âš¡ Running fast tests..."
      - source venv/bin/activate && pytest -v -m "not slow" --tb=short
      - echo "âœ… Test suite validation complete - all systems working!"

  install:
    desc: "Install required dependencies"
    cmd: source venv/bin/activate && pip install -r requirements.txt

  install:all:
    desc: "Install all dependencies"
    deps: [install]

  help:
    desc: "Show available commands"
    cmd: task --list

  test-echo:
    desc: "Test echo command"
    cmd: echo "Hello from Task!"